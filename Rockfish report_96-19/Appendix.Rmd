---
output: 
  word_document:
    reference_docx: "..\\doc_styles\\word_styles_FDS_break.docx"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, fig.cap = TRUE, fig.align = 'center')
source("..\\functions.R")
library(ggplot2)
library(flextable)
library(tidyverse)

est_spp <- readRDS(".\\composition\\est_spp.rds")
est_assem <- readRDS(".\\composition\\est_assem.rds")
est_sex <- readRDS(".\\composition\\est_sex.rds")
est_age <- readRDS(".\\composition\\est_age.rds")
est_lgbin <- readRDS(".\\composition\\est_lgbin.rds")

WriteXLS::WriteXLS(c("est_spp", "est_assem", "est_sex", "est_age", "est_lgbin"),
                   "Rockfish9619reportcomp.xls")
```

#########
Appendix A1.- Species composition of rockfish harvests from five Gulf of Alaska ports, 1996-2019.
```{r}
tab_spp <- 
  est_spp %>%
  mutate(sep_pys = sqrt(vp_pys),
         sepboot_pys = sqrt(vpboot_pys),
         sepreport_pys = ifelse(is.na(vpboot_pys), sep_pys * 2, sepboot_pys),
         est = paste0(format(round(p_pys, 3), digits = 3), " (", format(round(sepreport_pys, 3), digits = 3), ")"),
         year = as.character(year)) %>%
  pivot_wider(id_cols = c("port", "year"), names_from = "spp", values_from = "est")

filter(tab_spp) %>%
  flextable() %>%
  merge_v(j = ~ port) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:8), align = "right") %>%
  align(part = "header", j = c(3:8), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
 
#########
Appendix B1.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 1996.
```{r}
agetab_bl <- 
  est_age %>%
  rowwise() %>%
  filter(spp %in% "Black") %>%
  mutate(p_pysa_report = ifelse(p05a == FALSE || is.na(p05a) || min < 20, ppool_pysa, p_pysa),
         sep_pysa_report = ifelse(p05a == FALSE || is.na(p05a) || min < 20, seppool_pysa, sep_pysa),
         est = ifelse(is.na(p_pysa_report),
                      NA,
                      paste0(format(round(p_pysa_report, 3), digits = 3), " (", format(round(sep_pysa_report, 3), digits = 3), ")")),
         lcilogitp_pysa = log(p_pysa_report / (1-p_pysa_report)) - 1.96 * sqrt(1 / p_pysa_report^2 / (1-p_pysa_report)^2 * sep_pysa_report^2),
         ucilogitp_pysa = log(p_pysa_report / (1-p_pysa_report)) + 1.96 * sqrt(1 / p_pysa_report^2 / (1-p_pysa_report)^2 * sep_pysa_report^2),
         lcip_pysa = exp(lcilogitp_pysa)/(1 + exp(lcilogitp_pysa)),
         ucip_pysa = exp(ucilogitp_pysa)/(1 + exp(ucilogitp_pysa)),
         est_ci = ifelse(is.na(p_pysa_report),
                      NA,
                      paste0(format(round(p_pysa_report, 3), digits = 3),
                             "(",
                             format(round(lcip_pysa, 3), digits = 3),
                             "-",
                             format(round(ucip_pysa, 3), digits = 3),
                             ")")),
         year = as.character(year),
         port = paste0(port, " (", n, ")"))

agetab_bl %>%
  filter(year == "1996") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:6), align = "right") %>%
  align(part = "header", j = c(3:6), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
 
#########
Appendix B2.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 1997.
```{r}
agetab_bl %>%
  filter(year == "1997") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:6), align = "right") %>%
  align(part = "header", j = c(3:6), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B3.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 1998.
```{r}
agetab_bl %>%
  filter(year == "1998") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:6), align = "right") %>%
  align(part = "header", j = c(3:6), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B4.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 1999.
```{r}
agetab_bl %>%
  filter(year == "1999") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B5.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2000.
```{r}
agetab_bl %>%
  filter(year == "2000") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B6.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2001.
```{r}
agetab_bl %>%
  filter(year == "2001") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B7.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2002.
```{r}
agetab_bl %>%
  filter(year == "2002") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B8.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2003.
```{r}
agetab_bl %>%
  filter(year == "2003") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B9.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2004.
```{r}
agetab_bl %>%
  filter(year == "2004") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B10.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2005.
```{r}
agetab_bl %>%
  filter(year == "2005") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B11.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2006.
```{r}
agetab_bl %>%
  filter(year == "2006") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B12.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2007.
```{r}
agetab_bl %>%
  filter(year == "2007") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B13.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2008.
```{r}
agetab_bl %>%
  filter(year == "2008") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B14.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2009.
```{r}
agetab_bl %>%
  filter(year == "2009") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B15.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2010.
```{r}
agetab_bl %>%
  filter(year == "2010") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B16.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2011.
```{r}
agetab_bl %>%
  filter(year == "2011") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B17.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2012.
```{r}
agetab_bl %>%
  filter(year == "2012") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B18.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2013.
```{r}
agetab_bl %>%
  filter(year == "2013") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B19.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2014.
```{r}
agetab_bl %>%
  filter(year == "2014") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B20.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2015.
```{r}
agetab_bl %>%
  filter(year == "2015") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B21.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2016.
```{r}
agetab_bl %>%
  filter(year == "2016") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B22.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2017.
```{r}
agetab_bl %>%
  filter(year == "2017") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B23.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2018.
```{r}
agetab_bl %>%
  filter(year == "2018") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix B24.- Age composition of black rockfish in the harvest from five Gulf of Alaska ports in 2019.
```{r}
agetab_bl %>%
  filter(year == "2019") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
#########
 
Appendix C1.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 1996. 
```{r, results = "asis"}
agetab_ye <- 
  est_age %>%
  rowwise() %>%
  filter(spp %in% "Yelloweye") %>%
  mutate(p_pysa_report = ifelse(p05a == FALSE || is.na(p05a) || min < 20, ppool_pysa, p_pysa),
         sep_pysa_report = ifelse(p05a == FALSE || is.na(p05a) || min < 20, seppool_pysa, sep_pysa),
         est = ifelse(is.na(p_pysa_report),
                      NA,
                      paste0(format(round(p_pysa_report, 3), digits = 3), " (", format(round(sep_pysa_report, 3), digits = 3), ")")),
         lcilogitp_pysa = log(p_pysa_report / (1-p_pysa_report)) - 1.96 * sqrt(1 / p_pysa_report^2 / (1-p_pysa_report)^2 * sep_pysa_report^2),
         ucilogitp_pysa = log(p_pysa_report / (1-p_pysa_report)) + 1.96 * sqrt(1 / p_pysa_report^2 / (1-p_pysa_report)^2 * sep_pysa_report^2),
         lcip_pysa = exp(lcilogitp_pysa)/(1 + exp(lcilogitp_pysa)),
         ucip_pysa = exp(ucilogitp_pysa)/(1 + exp(ucilogitp_pysa)),
         est_ci = ifelse(is.na(p_pysa_report),
                      NA,
                      paste0(format(round(p_pysa_report, 3), digits = 3), 
                             "(", 
                             format(round(lcip_pysa, 3), digits = 3), 
                             "-",
                             format(round(ucip_pysa, 3), digits = 3),
                             ")")),
         year = as.character(year),
         port = paste0(port, " (", n, ")"))

agetab_ye %>%
  filter(year == "1996") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable()  %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:5), align = "right") %>%
  align(part = "header", j = c(3:5), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C2.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 1997. 
```{r}
agetab_ye %>%
  filter(year == "1997") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:6), align = "right") %>%
  align(part = "header", j = c(3:6), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C3.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 1998. 
```{r}
agetab_ye %>%
  filter(year == "1998") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:6), align = "right") %>%
  align(part = "header", j = c(3:6), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C4.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 1999. 
```{r}
agetab_ye %>%
  filter(year == "1999") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C5.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2000. 
```{r}
agetab_ye %>%
  filter(year == "2000") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C6.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2001. 
```{r}
agetab_ye %>%
  filter(year == "2001") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C7.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2002. 
```{r}
agetab_ye %>%
  filter(year == "2002") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C8.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2003. 
```{r}
agetab_ye %>%
  filter(year == "2003") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C9.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2004. 
```{r}
agetab_ye %>%
  filter(year == "2004") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C10.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2005. 
```{r}
agetab_ye %>%
  filter(year == "2005") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C11.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2006. 
```{r}
agetab_ye %>%
  filter(year == "2006") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C12.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2007. 
```{r}
agetab_ye %>%
  filter(year == "2007") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C13.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2008. 
```{r}
agetab_ye %>%
  filter(year == "2008") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C14.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2009. 
```{r}
agetab_ye %>%
  filter(year == "2009") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C15.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2010. 
```{r}
agetab_ye %>%
  filter(year == "2010") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C16.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2011. 
```{r}
agetab_ye %>%
  filter(year == "2011") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C17.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2012. 
```{r}
agetab_ye %>%
  filter(year == "2012") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C18.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2013. 
```{r}
agetab_ye %>%
  filter(year == "2013") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C19.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2014. 
```{r}
agetab_ye %>%
  filter(year == "2014") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C20.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2015. 
```{r}
agetab_ye %>%
  filter(year == "2015") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C21.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2016. 
```{r}
agetab_ye %>%
  filter(year == "2016") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C22.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2017. 
```{r}
agetab_ye %>%
  filter(year == "2017") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C23.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2018. 
```{r}
agetab_ye %>%
  filter(year == "2018") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix C24.- Age composition of yelloweye rockfish in the harvest from five Gulf of Alaska ports in 2019. 
```{r}
agetab_ye %>%
  filter(year == "2019") %>%
  pivot_wider(id_cols = c("year", "age"), names_from = "port", values_from = "est") %>%
  arrange(age) %>%
  flextable() %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:7), align = "right") %>%
  align(part = "header", j = c(3:7), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
  
#########
Appendix D1.- Length composition of Black rockfish in the harvest from five Gulf of Alaska ports. 
```{r, results = "asis"}
lgbin_format <- 
  est_lgbin %>%
  rowwise() %>%
  filter(spp %in% c("Black", "Yelloweye")) %>%
  mutate(p_pysl_report = ifelse(p05a == FALSE | is.na(p05a) | min < 10, ppool_pysl, p_pysl),
         sep_pysl_report = ifelse(p05a == FALSE | is.na(p05a) | min < 10, seppool_pysl, sep_pysl),
         est = ifelse(is.na(p_pysl_report),
                      NA,
                      paste0(format(round(p_pysl_report, 3), digits = 3), "(", format(round(sep_pysl_report, 3), digits = 3), ")")),
         lcilogitp_pysl = log(p_pysl_report / (1-p_pysl_report)) - 1.96 * sqrt(1 / p_pysl_report^2 / (1-p_pysl_report)^2 * sep_pysl_report^2),
         ucilogitp_pysl = log(p_pysl_report / (1-p_pysl_report)) + 1.96 * sqrt(1 / p_pysl_report^2 / (1-p_pysl_report)^2 * sep_pysl_report^2),
         lcip_pysl = exp(lcilogitp_pysl)/(1 + exp(lcilogitp_pysl)),
         ucip_pysl = exp(ucilogitp_pysl)/(1 + exp(ucilogitp_pysl)),
         est_ci = ifelse(is.na(p_pysl_report),
                         NA,
                         paste0(format(round(p_pysl_report, 3), digits = 3), 
                                "(", 
                                format(round(lcip_pysl, 3), digits = 3), 
                                "-",
                                format(round(ucip_pysl, 3), digits = 3),
                                ")")),
         year = as.character(year))


lgbin_format %>%
  filter(spp == "Black") %>%
  pivot_wider(id_cols = c("year", "lgbin"), names_from = "port", values_from = "est") %>%
  arrange(year, lgbin) %>%
  flextable()  %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:5), align = "right") %>%
  align(part = "header", j = c(3:5), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
 
#########
Appendix E1.- Length composition of Yelloweye rockfish in the harvest from five Gulf of Alaska ports. 
```{r, results = "asis"}
lgbin_format <- 
  est_lgbin %>%
  rowwise() %>%
  filter(spp %in% c("Black", "Yelloweye")) %>%
  mutate(p_pysl_report = ifelse(p05a == FALSE | is.na(p05a) | min < 10, ppool_pysl, p_pysl),
         sep_pysl_report = ifelse(p05a == FALSE | is.na(p05a) | min < 10, seppool_pysl, sep_pysl),
         est = ifelse(is.na(p_pysl_report),
                      NA,
                      paste0(format(round(p_pysl_report, 3), digits = 3), "(", format(round(sep_pysl_report, 3), digits = 3), ")")),
         lcilogitp_pysl = log(p_pysl_report / (1-p_pysl_report)) - 1.96 * sqrt(1 / p_pysl_report^2 / (1-p_pysl_report)^2 * sep_pysl_report^2),
         ucilogitp_pysl = log(p_pysl_report / (1-p_pysl_report)) + 1.96 * sqrt(1 / p_pysl_report^2 / (1-p_pysl_report)^2 * sep_pysl_report^2),
         lcip_pysl = exp(lcilogitp_pysl)/(1 + exp(lcilogitp_pysl)),
         ucip_pysl = exp(ucilogitp_pysl)/(1 + exp(ucilogitp_pysl)),
         est_ci = ifelse(is.na(p_pysl_report),
                         NA,
                         paste0(format(round(p_pysl_report, 3), digits = 3), 
                                "(", 
                                format(round(lcip_pysl, 3), digits = 3), 
                                "-",
                                format(round(ucip_pysl, 3), digits = 3),
                                ")")),
         year = as.character(year))


lgbin_format %>%
  filter(spp == "Yelloweye") %>%
  pivot_wider(id_cols = c("year", "lgbin"), names_from = "port", values_from = "est") %>%
  arrange(year, lgbin) %>%
  flextable()  %>%
  merge_v(j = ~ year) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:5), align = "right") %>%
  align(part = "header", j = c(3:5), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  autofit()
```
 
#########
Appendix F1.- Percentage of female of black rockfish in the harvest from five Gulf of Alaska ports.
```{r}
est_sex %>%
  filter(spp == "Black" & sex == "F") %>%
  mutate(p_pysx_report = ppool_pysx,
         sep_pysx_report = sqrt(vppool_pysx),
         est = ifelse(is.na(p_pysx),
                      NA,
                      paste0(format(round(p_pysx_report, 3), digits = 3), " (", format(round(sep_pysx_report, 3), digits = 3), ")")),
         lcilogitp_pysx = log(p_pysx_report / (1-p_pysx_report)) - 1.96 * sqrt(1 / p_pysx_report^2 / (1-p_pysx_report)^2 * sep_pysx_report^2),
         ucilogitp_pysx = log(p_pysx_report / (1-p_pysx_report)) + 1.96 * sqrt(1 / p_pysx_report^2 / (1-p_pysx_report)^2 * sep_pysx_report^2),
         lcip_pysx = exp(lcilogitp_pysx)/(1 + exp(lcilogitp_pysx)),
         ucip_pysx = exp(ucilogitp_pysx)/(1 + exp(ucilogitp_pysx)),
         year = as.character(year))  %>%
  pivot_wider(id_cols = "year", names_from = "port", values_from = "est") %>%
  flextable() %>%
    valign(j = 1, valign = "top") %>%
    align(j = c(2:6), align = "right") %>%
    align(part = "header", j = c(2:6), align = "right") %>%
    line_spacing(space = 0.5) %>%
    font(fontname = "Times New Roman") %>%
    fontsize(size = 10) %>%
    autofit()
```
 
#########
Appendix G1.- Percentage of female of yelloweye rockfish in the harvest from five Gulf of Alaska ports.
```{r}
est_sex %>%
  filter(spp == "Yelloweye" & sex == "F") %>%
  mutate(p_pysx_report = ppool_pysx,
         sep_pysx_report = sqrt(vppool_pysx),
         est = ifelse(is.na(p_pysx),
                      NA,
                      paste0(format(round(p_pysx_report, 3), digits = 3), " (", format(round(sep_pysx_report, 3), digits = 3), ")")),
         lcilogitp_pysx = log(p_pysx_report / (1-p_pysx_report)) - 1.96 * sqrt(1 / p_pysx_report^2 / (1-p_pysx_report)^2 * sep_pysx_report^2),
         ucilogitp_pysx = log(p_pysx_report / (1-p_pysx_report)) + 1.96 * sqrt(1 / p_pysx_report^2 / (1-p_pysx_report)^2 * sep_pysx_report^2),
         lcip_pysx = exp(lcilogitp_pysx)/(1 + exp(lcilogitp_pysx)),
         ucip_pysx = exp(ucilogitp_pysx)/(1 + exp(ucilogitp_pysx)),
         year = as.character(year))  %>%
  pivot_wider(id_cols = "year", names_from = "port", values_from = "est") %>%
  flextable() %>%
    valign(j = 1, valign = "top") %>%
    align(j = c(3:4), align = "right") %>%
    align(part = "header", j = c(3:4), align = "right") %>%
    line_spacing(space = 0.5) %>%
    font(fontname = "Times New Roman") %>%
    fontsize(size = 10) %>%
    autofit()
```

#########
Appendix H1.- Model selection criteria for spatial composition of bottomfish effort from five Gulf of Alaska ports.
```{r}
tab_sd <- readRDS("tab_sd.rds")

#input loocv log likelihoods
ll_Hp <- readRDS(".\\Interview post\\ll_Hp.rds")
ll_Hnpy <- readRDS(".\\Interview post\\ll_Hnpy.rds")
ll_E <- readRDS(".\\Interview post\\ll_E.rds")

#tables with model selection criteria. One for each composition
mod_p <-
  Map(function(x, y){tab_ll(x) %>% dplyr::mutate(port = y, composition = "Harvest: Pelagic")}, 
      x = ll_Hp,
      y = factor(c("Homer", "Kodiak", "Seward", "Valdez", "Whittier"), ordered = TRUE)) %>%
  do.call(rbind, .) %>% 
  dplyr::arrange(desc(composition), port) %>%
  dplyr::select(port, composition, model, ll, diff, p_diff) %>%
  dplyr::left_join(tab_sd, by = c("port", "composition", "model")) %>%
  mutate(port = ifelse(port == "Homer", "Cook Inlet", port))
mod_npy <-
  Map(function(x, y){tab_ll(x) %>% dplyr::mutate(port = y, composition = "Harvest: Non-Pelagic")}, 
      x = ll_Hnpy,
      y = factor(c("Homer", "Kodiak", "Seward", "Valdez", "Whittier"), ordered = TRUE)) %>%
  do.call(rbind, .) %>% 
  dplyr::arrange(desc(composition), port) %>%
  dplyr::select(port, composition, model, ll, diff, p_diff) %>%
  dplyr::left_join(tab_sd, by = c("port", "composition", "model")) %>%
  mutate(port = ifelse(port == "Homer", "Cook Inlet", port))
mod_E <-
  Map(function(x, y){tab_ll(x) %>% dplyr::mutate(port = y, composition = "Effort")}, 
      x = ll_E,
      y = factor(c("Homer", "Kodiak", "Seward", "Valdez", "Whittier"), ordered = TRUE)) %>%
  do.call(rbind, .) %>% 
  dplyr::arrange(desc(composition), port) %>%
  dplyr::select(port, composition, model, ll, diff, p_diff) %>%
  dplyr::left_join(tab_sd, by = c("port", "composition", "model")) %>%
  mutate(port = ifelse(port == "Homer", "Cook Inlet", port))
  
flextable(mod_E[, -2]) %>%
  merge_v(j = ~ port) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:6), align = "right") %>%
  align(part = "header", j = c(3:6), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>%
  mk_par(part = "header", j = "port", value = as_paragraph("Port")) %>%
  mk_par(part = "header", j = "model", value = as_paragraph("Model")) %>%
  mk_par(part = "header", j = "ll", value = as_paragraph("lppd", as_sub("m"))) %>%
  mk_par(part = "header", j = "diff", value = as_paragraph("\U0394llpd", as_sub("m"), "(SE)")) %>%
  mk_par(part = "header", j = "p_diff", value = as_paragraph("P(\U0394llpd", as_sub("m"), ">0)")) %>%
  mk_par(part = "header", j = "sd", value = as_paragraph("\U03C3", as_sub("re"))) %>%
  bold(i = c(3, 6, 10, 15, 18), j = 2:6) %>%
  autofit()
```

#########
Appendix H2.- Model selection criteria for spatial composition of pelagic rockfish harvest from five Gulf of Alaska ports. 
```{r}
flextable(mod_p[, -2]) %>%
  merge_v(j = ~ port) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:6), align = "right") %>%
  align(part = "header", j = c(3:6), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>% 
  mk_par(part = "header", j = "port", value = as_paragraph("Port")) %>%
  mk_par(part = "header", j = "model", value = as_paragraph("Model")) %>%
  mk_par(part = "header", j = "ll", value = as_paragraph("lppd", as_sub("m"))) %>% 
  mk_par(part = "header", j = "diff", value = as_paragraph("\U0394llpd", as_sub("m"), "(SE)")) %>% 
  mk_par(part = "header", j = "p_diff", value = as_paragraph("P(\U0394llpd", as_sub("m"), ">0)")) %>% 
  mk_par(part = "header", j = "sd", value = as_paragraph("\U03C3", as_sub("re"))) %>%
  bold(i = c(1, 4, 9, 13, 16), j = 2:6) %>%
  autofit()
```

#########
Appendix H3.- Model selection criteria for spatial composition of non-pelagic rockfish harvest from five Gulf of Alaska ports. 
```{r}
flextable(mod_npy[, -2]) %>%
  merge_v(j = ~ port) %>%
  valign(j = 1, valign = "top") %>%
  align(j = c(3:6), align = "right") %>%
  align(part = "header", j = c(3:6), align = "right") %>%
  line_spacing(space = 0.5) %>%
  font(fontname = "Times New Roman") %>%
  fontsize(size = 10) %>% 
  mk_par(part = "header", j = "port", value = as_paragraph("Port")) %>%
  mk_par(part = "header", j = "model", value = as_paragraph("Model")) %>%
  mk_par(part = "header", j = "ll", value = as_paragraph("lppd", as_sub("m"))) %>% 
  mk_par(part = "header", j = "diff", value = as_paragraph("\U0394llpd", as_sub("m"), "(SE)")) %>% 
  mk_par(part = "header", j = "p_diff", value = as_paragraph("P(\U0394llpd", as_sub("m"), ">0)")) %>% 
  mk_par(part = "header", j = "sd", value = as_paragraph("\U03C3", as_sub("re"))) %>%
  bold(i = c(1, 4, 7, 12, 14), j = 2:6) %>%
  autofit()
```

#########
Appendix I1.- Mean spatial composition estimates for rockfish effort and harvest from Cook Inlet ports, 2000-2019.
```{r, message = FALSE}
mod_p <- readRDS(".\\mod_p.rds")
mod_p2 <- mapply(function(x, y) mutate(x, statistic = y), x = mod_p, y = rep(c("Effort", "Pelagic H.", "Non-pelagic H."), times = 5))

mod_p2[1:3] %>% 
  do.call(rbind, .) %>%
  select(statistic, everything()) %>%
  mutate(year = as.character(year)) %>%
  flextable() %>%
    merge_v(j = ~ statistic) %>%
    valign(j = c(1, 2), valign = "top") %>%
    line_spacing(space = 0.4) %>%
    font(fontname = "Times New Roman") %>%
    fontsize(size = 9) %>%
    width(width = 1/12 * c(11, 7, 6, 12, 12, 12, 12, 12))
```
  
#########
Appendix I2.- Mean spatial composition estimates for rockfish effort and harvest from Kodiak, 2000-2019.
```{r, message = FALSE}
mod_p2[4:6] %>% 
  do.call(rbind, .) %>%
  select(statistic, everything()) %>%
  mutate(year = as.character(year)) %>%
  flextable() %>%
    merge_v(j = "statistic") %>%
    valign(j = c(1, 2), valign = "top") %>%
    line_spacing(space = 0.4) %>%
    font(fontname = "Times New Roman") %>%
    fontsize(size = 9) %>%
    width(width = 1/12 * c(11, 7, 6, 12, 12, 12, 12))
```

#########
Appendix I3.- Mean spatial composition estimates for rockfish effort and harvest from Seward, 2000-2019.
```{r, message = FALSE}
mod_p2[7:9] %>% 
  do.call(rbind, .) %>%
  select(statistic, everything()) %>%
  mutate(year = as.character(year)) %>%
  flextable() %>%
    merge_v(j = c("statistic", "fleet")) %>%
    valign(j = c(1, 2), valign = "top") %>%
    line_spacing(space = 0.4) %>%
    font(fontname = "Times New Roman") %>%
    fontsize(size = 9) %>%
    width(width = 1/12 * c(11, 7, 6, 12, 12, 13, 12))
```

#########
Appendix I4.- Mean spatial composition estimates for rockfish effort and harvest from Valdez, 2000-2019.
```{r, message = FALSE}
mod_p2[10:12] %>% 
  do.call(rbind, .) %>%
  select(statistic, everything()) %>%
  mutate(year = as.character(year)) %>%
  flextable() %>%
    merge_v(j = c("statistic", "fleet")) %>%
    valign(j = c(1, 2), valign = "top") %>%
    line_spacing(space = 0.4) %>%
    font(fontname = "Times New Roman") %>%
    fontsize(size = 9) %>%
    width(width = 1/12 * c(11, 7, 6, 12, 12, 12))
```

#########
Appendix I5.- Mean spatial composition estimates for rockfish effort and harvest from Whittier, 2000-2019.
```{r, message = FALSE}
mod_p2[13:15] %>% 
  do.call(rbind, .) %>%
  select(statistic, everything()) %>%
  mutate(year = as.character(year)) %>%
  flextable() %>%
    merge_v(j = c("statistic", "fleet")) %>%
    valign(j = c(1, 2), valign = "top") %>%
    line_spacing(space = 0.4) %>%
    font(fontname = "Times New Roman") %>%
    fontsize(size = 9) %>%
    width(width = 1/12 * c(11, 7, 6, 12, 12, 12))
```